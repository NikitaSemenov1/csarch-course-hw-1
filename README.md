# ИДЗ №1 по АВС. Вариант №8, Семенов Никита БПИ214

## Условие задачи
> Сформировать массив B по следующим правилам:
> * если Ai > 5, то увеличить элемент на 5,
> * eсли Ai < -5, то уменьшить на 5,
> * остальныое обнулить.

## Отчет

Решение писалось сразу на 7 баллов. В отдельный модуль (`array_logic.c`) вынесена логика обработки массивов. В нем реализованы 6 функций:
- **alloc_array** - выделяет массив нужной длины в куче;
- **free_array** - освобождает выделенный массив;
- **input_array** - вводит массив нужной длины из указанного потока ввода;
- **validate_size** - валидирует введенную с консоли длину массива;
- **print_array** - выводит массив в указанный поток вывода.
- **build_array** - строит по массиву A массив B.

Опции компиляции прописаны в Makefile'ах.

 Аргументы командной строки:
 - `-i` - ввод/вывод производится через консоль;
 - `-f <input-file> <output-file>` - ввод/вывод производится из файлов `input-file`/`output-file`.

## Рефакторинг сгенерированных ассемблерных файлов

Во всех функциях, включая main, убрано обращение на стек. Все операнды инструкций хранятся в регистрах. В функциях `print_array`, `input_array` значения регистров вызванной функции `r12, r13, r14, r15` сохранены на стек для последующего хранения в них локальных переменных.

## Тестирование

Для тестирования эквивалентности оптимизированной и сгенерированных программ, приведены 5 тестов с различными, в том числе некорректными, данными. В папке `tests/` расположены входные данные тестов. В папке `tests/output` расположены файлы результаты работы сгененерированного ассемблерного кода. В папке `tests/opt_output` расположены результаты работы оптимизированной ассемблерной программы.